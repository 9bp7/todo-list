!function(e){var t={};function o(a){if(t[a])return t[a].exports;var l=t[a]={i:a,l:!1,exports:{}};return e[a].call(l.exports,l,l.exports,o),l.l=!0,l.exports}o.m=e,o.c=t,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)o.d(a,l,function(t){return e[t]}.bind(null,l));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);const a=(e,t=!1)=>{let o=[];return{getJSON:()=>{let a={};return a.title=e,a.favourite=t,a.tasks=[],o.forEach(e=>{a.tasks.push(JSON.parse(e.getJSON()))}),JSON.stringify(a)},addTask:e=>o.push(e),getTask:e=>o[e],getTasks:()=>o,getTitle:()=>e,deleteTask:e=>{const t=o.indexOf(e);t>-1&&o.splice(t,1)},isFavourite:()=>t}},l=(()=>{let e=[];return{addProject:t=>e.push(t),deleteProject:t=>{const o=e.indexOf(t);o>-1&&e.splice(o,1)},getAllProjects:()=>e,getProject:t=>e[t],getProjectCount:()=>e.length,getProjectIndex:t=>e.indexOf(t),saveExists:()=>!!localStorage.getItem("projects"),save:()=>{let t=[];e.forEach(e=>t.push(JSON.parse(e.getJSON()))),console.log(JSON.stringify(t))},load:()=>{}}})(),n=(()=>{let e=[];return{addModal:t=>(e.push(t),e.indexOf(t)),getModalIndex:t=>e.indexOf(t),hideAllOtherModals:t=>{for(let o=0;o<t.length;o++)o!==t?(e[o].hide(),console.log("hiding modalID: "+o)):console.log("keeping modalID: "+o)}}})(),d=e=>{let t=document.createElement("div");t.classList.add("modal"),t.dataset.modalid=n.addModal(t);const o=n.getModalIndex(t);let a=document.createElement("div");a.classList.add("modal-container"),a.dataset.modalid=o,a.appendChild(t),e.length>0&&(t.innerHTML+=`<h3 id="modal-title">${e}</h3>`);const l=()=>{a.classList.remove("show"),t.classList.remove("show"),a.remove()};t.innerHTML+='<h3 id="modal-close">✕</h3>',a.addEventListener("click",e=>{(e.target.classList.contains("modal-container")||"modal-close"===e.target.id)&&l()});return{modal:t,show:()=>{a.classList.add("show"),t.classList.add("show"),document.querySelector("body").appendChild(a)},hide:l}},r=(e,t,o,a,l,n,r=!1)=>{const s=d(e);t.length>0&&(s.modal.innerHTML+=`<p>${t}</p>`),r?(s.modal.innerHTML+=`<button data-modalbtn="confirm" class="modal-btn modal-confirm-btn-warn">${l}</button>`,s.modal.innerHTML+=`<button data-modalbtn="cancel" class="modal-btn modal-cancel-btn-warn">${n}</button>`):(s.modal.innerHTML+=`<button data-modalbtn="confirm" class="modal-btn modal-confirm-btn">${l}</button>`,s.modal.innerHTML+=`<button data-modalbtn="cancel" class="modal-btn modal-cancel-btn">${n}</button>`);(()=>{let e=s.modal.querySelector('button[data-modalbtn="confirm"]'),t=s.modal.querySelector('button[data-modalbtn="cancel"]');e.addEventListener("click",()=>{o(),s.hide()}),t.addEventListener("click",()=>{null!==a&&a(),s.hide()})})();return Object.assign({},s,{})},s=(e,t,o,a,l)=>{const n=d(e);let r='<form autocomplete="off">';r+=`<input type="submit" data-modalbtn="submit" class="modal-btn modal-confirm-btn" value="${a}">`,l.length>0&&(r+=`<button data-modalbtn="cancel" class="modal-btn modal-cancel-btn">${l}</button>`),r+="</form>",n.modal.innerHTML+=r;const s=()=>{let e=n.modal.querySelector("form");if(e&&e.addEventListener("submit",o=>{o.preventDefault();let a=new FormData(e);t(a)}),l.length>0){n.modal.querySelector('button[data-modalbtn="cancel"]').addEventListener("click",()=>{null!==o&&o(),n.hide()})}};return s(),Object.assign({},n,{show:()=>{n.show(),n.modal.querySelector("input").focus()},addFormHTML:e=>{let t=n.modal.querySelector("form");t.remove(),n.modal.innerHTML+=r,t=n.modal.querySelector("form"),t.innerHTML=e+t.innerHTML,s()},addErrorLabel:(e,t)=>{let o=n.modal.querySelector("form");if(!o.querySelector(`p[data-error="${t}"]`)){let a=o.querySelector("#"+t),l=document.createElement("p");l.classList.add("modal-error"),l.dataset.error=t,l.textContent=e,o.insertBefore(l,a.nextSibling)}},removeErrorLabel:e=>{let t=n.modal.querySelector(`p[data-error="${e}"]`);t&&t.remove()}})},i=(()=>{document.querySelectorAll("button");let e,t,o,n=document.querySelector("aside"),d=document.querySelector(".sidebar-favourites"),c=document.querySelector(".sidebar-projects"),u=document.querySelector(".display-inner"),m=[],p=!1,y={type:"",projects:[]},f=0,b=0,g=0;const k=(e,t)=>{y.type=e,y.projects=t};t=s("New Task",o=>{let a=!1,n={};for(let e of o.entries())"modifytask-name"===e[0]&&(0===e[1].length?(t.addErrorLabel("You need to enter a task name!",e[0]),a=!0):t.removeErrorLabel(e[0])),n[e[0]]=e[1];if(!a){let o=l.getProject(f),a=((e,t,o,a,l,n)=>{let d=!1,r=null;const s=Date.now();return{getJSON:()=>{let i={};return i.title=e,i.description=t,i.dueDate=o,i.priority=a,i.notes=l,i.checklist=n,i.completed=d,i.completionDate=r,i.creationDate=s,JSON.stringify(i)},setComplete:e=>{d=e,e&&(r=Date.now())},getComplete:()=>d,getCompletionDate:()=>r,getCreationDate:()=>s,setTitle:t=>e=t,setDescription:e=>t=e,setDueDate:e=>o=e,setPriority:e=>a=e,setNotes:e=>l=e,setChecklist:e=>n=e,getTitle:()=>e,getDescription:()=>t,getDueDate:()=>o,getPriority:()=>a,getNotes:()=>l,getChecklist:()=>n}})(n["modifytask-name"],n["modifytask-desc"],n["modifytask-duedate"],n["modifytask-priority"],n["modifytask-notes"],null);o.addTask(a),e(),t.hide()}},null,"Add Task","Cancel");const h=()=>{u.querySelectorAll('button[data-btn="new-task"]').forEach(e=>{e.addEventListener("click",()=>{f=e.dataset.projectid,t.addFormHTML('<input type="text" id="modifytask-name" name="modifytask-name" placeholder="Task name" tabindex="0">\n    <input type="text" id="modifytask-desc" name="modifytask-desc" placeholder="Description"> \n    <label for="modifytask-duedate">Due date (optional):</label>   \n    <input type="date" id="modifytask-duedate" name="modifytask-duedate">\n    <label for="modifytask-duedate">Priority:</label>   \n    <select id="modifytask-priority" name="modifytask-priority">\n      <option value="low">Low</option>\n      <option value="med">Medium</option>\n      <option value="high">High</option>\n    </select>\n    <textarea id="modifytask-notes" name="modifytask-notes" rows="3" placeholder="Add additional notes here"></textarea>'),t.show()})})};o=s("Edit Task",t=>{let a=!1,n={};for(let e of t.entries())"modifytask-name"===e[0]&&(0===e[1].length?(o.addErrorLabel("You need to enter a task name!",e[0]),a=!0):o.removeErrorLabel(e[0])),n[e[0]]=e[1];if(!a){let t=l.getProject(b).getTask(g);t.setTitle(n["modifytask-name"]),t.setDescription(n["modifytask-desc"]),t.setDueDate(n["modifytask-duedate"]),t.setPriority(n["modifytask-priority"]),t.setNotes(n["modifytask-notes"]),e(),o.hide()}},null,"Edit Task","Cancel");const j=()=>{document.querySelectorAll("li").forEach(e=>{e.querySelector('span[data-btn="edit-task"]')&&e.querySelector('span[data-btn="edit-task"]').addEventListener("click",()=>{b=+e.dataset.projectid,g=+e.dataset.projectindex;let t=l.getProject(b).getTask(g),a=t.getPriority(),n=`<input type="text" id="modifytask-name" name="modifytask-name" placeholder="Task name" value="${t.getTitle()}" tabindex="0">\n              <input type="text" id="modifytask-desc" name="modifytask-desc" value="${t.getDescription()}" placeholder="Description"> \n              <label for="modifytask-duedate">Due date (optional):</label>   \n              <input type="date" id="modifytask-duedate" value="${t.getDueDate()}" name="modifytask-duedate">\n              <label for="modifytask-duedate">Priority:</label>   \n              <select id="modifytask-priority" name="modifytask-priority">\n                <option value="low" ${"low"===a?"selected":""}>Low</option>\n                <option value="med" ${"med"===a?"selected":""}>Medium</option>\n                <option value="high" ${"high"===a?"selected":""}>High</option>\n              </select>\n              <textarea id="modifytask-notes" name="modifytask-notes" rows="3" placeholder="Add additional notes here">${t.getNotes()}</textarea>`;o.addFormHTML(n),o.show()})})},T=()=>{document.querySelectorAll("li").forEach(t=>{t.querySelector('span[data-btn="del-task"]')&&t.querySelector('span[data-btn="del-task"]').addEventListener("click",()=>{let o=l.getProject(+t.dataset.projectid),a=o.getTask(+t.dataset.projectindex);r("Delete Task",`Do you really wish to permanently delete task '${a.getTitle()}'?`,()=>((t,o)=>{t.deleteTask(o),e()})(o,a),null,"Delete Task","Cancel",!0).show()})})},L=()=>{u.innerHTML=""},v=e=>{let t=l.getProject(e);t.isFavourite()?u.innerHTML+=`<h3>${t.getTitle()}<button class="add-btn small-btn" data-btn="new-task" data-projectid=${e}>＋ Add Task</button></h3>`:u.innerHTML+=`<h3>${t.getTitle()}<button class="add-btn small-btn" data-btn="new-task" data-projectid=${e}>＋ Add Task</button><button class="add-btn delete-project-btn small-btn" data-btn="del-project" data-projectid=${e}>Delete Project</button></h3>`;let o=document.createElement("ul"),a=t.getTasks();a.sort((function(e,t){return e.getComplete()===t.getComplete()?0:e.getComplete()?1:-1}));for(let t=0;t<a.length;t++){let l=document.createElement("li");l.dataset.projectindex=t,l.dataset.projectid=e,a[t].getComplete()&&l.classList.add("todo-complete"),l.innerHTML+=`<input class="todo-tick" type="checkbox" ${a[t].getComplete()?"checked":""}><span class="todo-pri-${a[t].getPriority()}">${a[t].getTitle()}</span>`,a[t].getComplete()||(""!==a[t].getDescription()&&(l.innerHTML+=`<p class="todo-desc">${a[t].getDescription()}</p>`),""!==a[t].getDueDate()&&null!==a[t].getDueDate()&&(l.innerHTML+=`<p class="todo-desc">Due on ${a[t].getDueDate()}</p>`)),l.innerHTML+='<p class="todo-editdel"><span class="todo-edit" data-btn="edit-task">Edit</span> <span class="todo-del" data-btn="del-task">Delete</span></p>',o.appendChild(l)}u.appendChild(o),E()},S=e=>{L(),k("one",[l.getProject(e)]),v(e),P(),M(),h(),j(),T(),l.save()},D=()=>{L(),k("all",l.getAllProjects());for(let e=0;e<l.getProjectCount();e++)v(e);P(),M(),h(),j(),T(),l.save()};e=()=>{console.log("updating display"),"all"===y.type?D():"one"===y.type&&S(l.getProjectIndex(y.projects[0]))};const P=()=>{u.querySelectorAll("li").forEach(t=>{t.childNodes.forEach(o=>{"INPUT"===o.tagName&&"checkbox"===o.type&&(-1===m.indexOf(o)?(m.push(o),o.addEventListener("CheckboxStateChange",()=>{console.log("toggling completion task id "+t.dataset.projectindex),l.getProject(t.dataset.projectid).getTask(t.dataset.projectindex).setComplete(o.checked),e()})):console.log("event exists for "+t.textContent))})})},x=(document.querySelectorAll('button[data-btn="new-project"]').forEach(e=>{e.addEventListener("click",()=>{p=!p,E(!1),p&&(document.querySelector(".add-project-field").focus(),x())})}),()=>{let e=document.querySelector(".add-project-form"),t=document.querySelector(".add-project-field");e.addEventListener("submit",e=>{if(e.preventDefault(),""!==t.value){let e=a(t.value);l.addProject(e),p=!1,i.displayOneProject(l.getProjectIndex(e)),E()}})}),E=(e=!0)=>{d.innerHTML="",c.innerHTML="",(()=>{let e=l.getAllProjects(),t=document.querySelectorAll('button[data-btn="new-project"]'),o=0;e.forEach(e=>{e.isFavourite()?d.innerHTML+=`<li class="project-link" data-id=${o}>${e.getTitle()}</li>`:c.innerHTML+=`<li class="project-link" data-id=${o}>${e.getTitle()}</li>`,o++}),d.innerHTML+='<li class="project-link" data-id="all-tasks">All Tasks</li>',p?(t.forEach(e=>e.innerHTML="<span class='btn-symbol'>✕</span> Cancel"),c.innerHTML+='<div class="add-project"><form class="add-project-form"><input type="text" class="add-project-field" placeholder="Name your project"><input type="submit" class="add-project-submit" value="＋"></form></div>'):t.forEach(e=>e.innerHTML="<span class='btn-symbol'>＋</span> New Project")})(),(()=>{if("all"===y.type){d.querySelector('li[data-id="all-tasks"]').classList.add("selected")}else if("one"===y.type){let e=l.getProjectIndex(y.projects[0]);n.querySelector(`li[data-id="${e}"]`).classList.add("selected")}})(),n.querySelectorAll("li").forEach(e=>{e.addEventListener("click",()=>{"all-tasks"===e.dataset.id?i.displayAllProjects():i.displayOneProject(+e.dataset.id),p=!1,E()})})},M=()=>{u.querySelectorAll('button[data-btn="del-project"]').forEach(e=>{e.addEventListener("click",()=>{let t=l.getProject(+e.dataset.projectid);r("Delete "+t.getTitle(),`Do you really wish to permanently delete your project '${t.getTitle()}'?`,()=>(e=>{l.deleteProject(e),D(),E()})(t),null,"Delete Project","Cancel",!0).show()})})};return{displayOneProject:S,displayAllProjects:D}})();if(localStorage.clear(),!l.saveExists()){let e=a("Inbox",!0);l.addProject(e)}i.displayAllProjects()}]);